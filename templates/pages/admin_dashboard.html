{% extends 'base.html' %}
{% block page_title %}Panel Administrativo &middot; CO.RA.PAN{% endblock %}

{% block extra_head %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/md3/tokens.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/md3/typography.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/md3/components/hero.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/md3/components/admin-dashboard.css') }}">
{% endblock %}

{% block content %}
<!-- MD3 Admin Dashboard -->
<article class="md3-text-page">
  
  <!-- Hero Header (Container Hero - Tonal) -->
  <section class="md3-hero md3-hero--container md3-hero--with-icon" role="main" aria-label="Panel Administrativo">
    <div class="md3-hero__container">
      <span class="material-symbols-rounded md3-hero__icon" aria-hidden="true">dashboard</span>
      <div class="md3-hero__content">
        <span class="md3-hero__eyebrow">Panel Administrativo</span>
        <h1 class="md3-hero__title">Métricas y Configuración</h1>
        <p class="md3-hero__intro">
          Monitoriza accesos, visitas y búsquedas en la plataforma. Los datos se actualizan automáticamente.
        </p>
      </div>
    </div>
  </section>

  <!-- Main Content -->
  <div class="md3-text-content">
    
    <!-- Metrics Grid -->
    <div class="md3-admin-metrics" data-element="metrics-grid">
      
      <!-- Visits Card -->
      <div class="md3-metric-card md3-card md3-card--outlined" data-metric="visits">
        <div class="md3-metric-card__header">
          <div class="md3-metric-card__icon-wrapper">
            <span class="material-symbols-rounded">public</span>
          </div>
          <h3 class="md3-title-medium">Visitas</h3>
        </div>
        <div class="md3-metric-card__content">
          <div class="md3-metric-value-group">
            <span class="md3-label-medium">Total</span>
            <span class="md3-display-small" id="visits-total">-</span>
          </div>
          
          <details class="md3-metric-card__history">
            <summary>Detalles por mes/día</summary>
            <div class="md3-details__content">
              <h4 class="md3-title-small md3-space-3">Este mes</h4>
              <ul class="md3-list" id="visits-days-list">
                <!-- Populated by JS -->
              </ul>
              <h4 class="md3-title-small md3-space-3">Histórico mensual</h4>
              <ul class="md3-list" id="visits-months-list">
                <!-- Populated by JS -->
              </ul>
            </div>
          </details>
        </div>
      </div>

      <!-- Access Card -->
      <div class="md3-metric-card md3-card md3-card--outlined" data-metric="access">
        <div class="md3-metric-card__header">
          <div class="md3-metric-card__icon-wrapper">
            <span class="material-symbols-rounded">graphic_eq</span>
          </div>
          <h3 class="md3-title-medium">Acceso al Corpus</h3>
        </div>
        <div class="md3-metric-card__content">
          <div class="md3-metric-value-group">
            <span class="md3-label-medium">Total</span>
            <span class="md3-display-small" id="access-total">-</span>
          </div>
          
          <details class="md3-metric-card__history">
            <summary>Detalles por mes/día</summary>
            <div class="md3-details__content">
              <h4 class="md3-title-small md3-space-3">Este mes</h4>
              <ul class="md3-list" id="access-days-list">
                <!-- Populated by JS -->
              </ul>
              <h4 class="md3-title-small md3-space-3">Histórico mensual</h4>
              <ul class="md3-list" id="access-months-list">
                <!-- Populated by JS -->
              </ul>
            </div>
          </details>
        </div>
      </div>

      <!-- Search Card -->
      <div class="md3-metric-card md3-card md3-card--outlined" data-metric="search">
        <div class="md3-metric-card__header">
          <div class="md3-metric-card__icon-wrapper">
            <span class="material-symbols-rounded">search</span>
          </div>
          <h3 class="md3-title-medium">Búsquedas</h3>
        </div>
        <div class="md3-metric-card__content">
          <div class="md3-metric-value-group">
            <span class="md3-label-medium">Total</span>
            <span class="md3-display-small" id="search-total">-</span>
          </div>
          
          <details class="md3-metric-card__history">
            <summary>Detalles por mes/día</summary>
            <div class="md3-details__content">
              <h4 class="md3-title-small md3-space-3">Este mes</h4>
              <ul class="md3-list" id="search-days-list">
                <!-- Populated by JS -->
              </ul>
              <h4 class="md3-title-small md3-space-3">Histórico mensual</h4>
              <ul class="md3-list" id="search-months-list">
                <!-- Populated by JS -->
              </ul>
            </div>
          </details>
        </div>
      </div>
      
    </div>

    <!-- Info Card -->
    <div class="md3-admin-card md3-admin-card--info md3-space-6">
      <div class="md3-admin-card__header">
        <span class="material-symbols-rounded md3-admin-card__icon">info</span>
        <h2 class="md3-admin-card__title md3-title-large">Información del Sistema</h2>
      </div>
      <div class="md3-admin-card__body">
        <ul class="md3-admin-list md3-body-medium">
          <li>Los datos se almacenan en <code>data/counters/</code> y pueden sincronizarse con el backend</li>
          <li>Los logs del sistema se encuentran en <code>logs/corapan.log</code></li>
        </ul>
      </div>
    </div>

  </div>
</article>
{% endblock %}

{% block extra_scripts %}
  <script type="module" src="{{ url_for('static', filename='js/modules/admin/dashboard.js') }}" defer></script>
{% endblock %}
