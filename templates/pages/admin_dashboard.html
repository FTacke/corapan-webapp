{% extends 'base.html' %}
{% block page_title %}Admin-Dashboard &middot; CO.RA.PAN{% endblock %}

{% block extra_head %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/md3/tokens.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/md3/typography.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/md3/components/hero.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/md3/components/admin-dashboard.css') }}">
{% endblock %}

{% block content %}
<!-- MD3 Admin Dashboard - Analytics (Variante 3a: nur Zähler, keine Suchinhalte) -->
<div class="md3-page">
  <header class="md3-page__header">
    <div class="md3-hero md3-hero--card md3-hero__container">
      <div class="md3-hero__icon" aria-hidden="true"><span class="material-symbols-rounded">dashboard</span></div>
      <div class="md3-hero__content">
        <p class="md3-body-small md3-hero__eyebrow">Admin</p>
        <h1 class="md3-headline-medium md3-hero__title">Analytics Dashboard</h1>
        <p class="md3-body-medium md3-hero__intro">
          Anonyme Nutzungsstatistiken der letzten 30 Tage
        </p>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="md3-page__main">
    
    <!-- KPI Cards Grid -->
    <div class="md3-admin-metrics" data-element="metrics-grid">
      
      <!-- Visitors Card -->
      <div class="md3-metric-card md3-card md3-card--outlined">
        <div class="md3-metric-card__header">
          <div class="md3-metric-card__icon-wrapper">
            <span class="material-symbols-rounded">people</span>
          </div>
          <h3 class="md3-title-medium">Besuche</h3>
        </div>
        <div class="md3-metric-card__content">
          <span class="md3-display-small" id="visitors-total">–</span>
          <span class="md3-label-medium" id="device-breakdown">Mobile –% · Desktop –%</span>
        </div>
      </div>

      <!-- Searches Card -->
      <div class="md3-metric-card md3-card md3-card--outlined">
        <div class="md3-metric-card__header">
          <div class="md3-metric-card__icon-wrapper">
            <span class="material-symbols-rounded">search</span>
          </div>
          <h3 class="md3-title-medium">Suchanfragen</h3>
        </div>
        <div class="md3-metric-card__content">
          <span class="md3-display-small" id="searches-total">–</span>
        </div>
      </div>

      <!-- Audio Card -->
      <div class="md3-metric-card md3-card md3-card--outlined">
        <div class="md3-metric-card__header">
          <div class="md3-metric-card__icon-wrapper">
            <span class="material-symbols-rounded">play_circle</span>
          </div>
          <h3 class="md3-title-medium">Audio-Plays</h3>
        </div>
        <div class="md3-metric-card__content">
          <span class="md3-display-small" id="audio-total">–</span>
        </div>
      </div>

      <!-- Errors Card -->
      <div class="md3-metric-card md3-card md3-card--outlined">
        <div class="md3-metric-card__header">
          <div class="md3-metric-card__icon-wrapper">
            <span class="material-symbols-rounded">error</span>
          </div>
          <h3 class="md3-title-medium">Fehler</h3>
        </div>
        <div class="md3-metric-card__content">
          <span class="md3-display-small" id="errors-total">–</span>
        </div>
      </div>
      
    </div>

    <!-- Daily Chart -->
    <div class="md3-card md3-card--outlined md3-chart-card">
      <h2 class="md3-title-large md3-chart-card__title">Letzte 7 Tage</h2>
      <div id="daily-chart" class="md3-chart-container">
        <!-- Populated by JS -->
      </div>
    </div>

    <!-- VARIANTE 3a: Keine Top-Queries Sektion! Keine Suchinhalte gespeichert. -->

    <!-- Info Card -->
    <div class="md3-admin-card md3-admin-card--info md3-space-6">
      <div class="md3-admin-card__header">
        <span class="material-symbols-rounded md3-admin-card__icon">info</span>
        <h2 class="md3-admin-card__title md3-title-large">Datenschutz-Hinweis</h2>
      </div>
      <div class="md3-admin-card__body">
        <ul class="md3-admin-list md3-body-medium">
          <li>Es werden ausschließlich <strong>anonyme, aggregierte Zähler</strong> gespeichert</li>
          <li>Keine IP-Adressen, User-IDs, Cookies oder Fingerprints</li>
          <li>Keine Suchinhalte oder Query-Texte (Variante 3a)</li>
          <li>DSGVO-konform – kein Einwilligungsbanner erforderlich</li>
        </ul>
      </div>
    </div>

  </main>
</div>
{% endblock %}

{% block extra_scripts %}
  <script type="module" src="{{ url_for('static', filename='js/modules/admin/dashboard.js') }}" defer></script>
{% endblock %}
