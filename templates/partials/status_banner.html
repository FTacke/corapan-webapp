{% set user_name = g.get('user') %}
{% set user_role = g.get('role') %}
{% set is_authenticated = user_name is not none %}
<div class="status-banner" data-auth="{{ 'true' if is_authenticated else 'false' }}" data-role="{{ user_role.value if user_role else '' }}">
  <div class="status-message">
    <span class="status-label">Estado</span>
    {% if is_authenticated %}
      <span class="status-dot status-dot--online" aria-hidden="true"></span>
      Sesi&oacute;n iniciada como <strong>{{ user_name }}</strong>
    {% else %}
      <span class="status-dot status-dot--offline" aria-hidden="true"></span>
      Est&aacute;s viendo la versi&oacute;n p&uacute;blica.
    {% endif %}
  </div>
  <div class="status-actions">
    {% if is_authenticated %}
      <form method="post" action="{{ url_for('auth.logout') }}" data-element="logout-form">
        <input type="hidden" name="referrer" value="{{ request.url }}">
        <input type="hidden" name="csrf_token" value="" data-element="csrf-token">
        <button type="submit" class="btn btn-inline">Cerrar sesi&oacute;n</button>
      </form>
    {% else %}
      <button class="btn" data-action="open-login">Iniciar sesi&oacute;n</button>
    {% endif %}
  </div>
</div>
<div class="login-sheet" hidden data-element="login-sheet">
  <form class="login-form" method="post" action="{{ url_for('auth.login') }}">
    <h2>Acceso CO.RA.PAN</h2>
    <input type="hidden" name="referrer" value="{{ request.url }}">
    <label>
      <span>Cuenta</span>
      <input type="text" name="username" autocomplete="username" required>
    </label>
    <label>
      <span>Contrase&ntilde;a</span>
      <input type="password" name="password" autocomplete="current-password" required>
    </label>
    <button type="submit" class="btn">Continuar</button>
  </form>
  <button class="btn btn-inline" data-action="close-login">Cancelar</button>
</div>
