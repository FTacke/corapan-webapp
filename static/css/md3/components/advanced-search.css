/**
 * Advanced Search MD3 Components
 * 
 * MD3-konformes Layout für Advanced Search.
 * Keine Inline-Styles. Alle Styles nutzen CSS-Variablen aus tokens.css.
 * 
 * Struktur:
 * - .md3-advanced: Container
 * - .md3-advanced__form: Formular
 * - .md3-advanced__row: Zeilen für Query/Filter
 * - .md3-advanced__summary: Results Summary
 * - .md3-advanced__toolbar: Export-Buttons
 * - .md3-advanced__tablewrap: DataTables Container
 */

/* ========================================
   CONTAINER
   ======================================== */

.md3-advanced {
  padding-block: var(--space-4, 1rem);
  max-width: 1400px;
  margin-inline: auto;
}

/* ========================================
   FORM LAYOUT
   ======================================== */

.md3-advanced__form {
  display: flex;
  flex-direction: column;
  gap: var(--space-4, 1rem);
  margin-block-end: var(--space-6, 1.5rem);
}

/* Row: Query + Mode + Expert */
.md3-advanced__row {
  display: grid !important;
  gap: var(--space-3, 0.75rem);
  align-items: end;
}

.md3-advanced__row--query {
  grid-template-columns: 1fr 220px max-content !important;
}

/* Row: CQL Raw (hidden by default) */
.md3-advanced__row--cql {
  margin-block: var(--space-2, 0.5rem) 0;
}

.md3-advanced__row--cql[hidden] {
  display: none;
}

/* Row: Filters (5 columns on desktop) */
.md3-advanced__row--filters {
  grid-template-columns: repeat(5, minmax(0, 1fr)) !important;
  gap: var(--space-3, 0.75rem);
}

/* Responsive: Stack filters on mobile/tablet */
@media (max-width: 960px) {
  .md3-advanced__row--query {
    grid-template-columns: 1fr !important;
  }
  
  .md3-advanced__row--filters {
    grid-template-columns: 1fr 1fr !important;
  }
}

@media (max-width: 600px) {
  .md3-advanced__row--filters {
    grid-template-columns: 1fr !important;
  }
}

/* ========================================
   EXPERT TOGGLE (Switch-Style)
   ======================================== */

.md3-advanced__expert {
  display: flex;
  align-items: center;
  gap: var(--space-2, 0.5rem);
  cursor: pointer;
  user-select: none;
  padding: var(--space-2, 0.5rem);
  white-space: nowrap;
}

.md3-advanced__expert input[type="checkbox"] {
  /* Visually hidden but accessible */
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

.md3-advanced__expert::before {
  content: '';
  display: block;
  width: 52px;
  height: 32px;
  background-color: var(--md-sys-color-surface-variant, #f3edf7);
  border: 2px solid var(--md-sys-color-outline, #79747E);
  border-radius: 16px;
  position: relative;
  transition: all 0.2s ease;
}

.md3-advanced__expert input:checked + span::before {
  background-color: var(--md-sys-color-primary, #0a5981);
  border-color: var(--md-sys-color-primary, #0a5981);
}

.md3-advanced__expert::after {
  content: '';
  position: absolute;
  left: var(--space-2, 0.5rem);
  width: 20px;
  height: 20px;
  background-color: var(--md-sys-color-outline, #79747E);
  border-radius: 50%;
  transition: all 0.2s ease;
}

.md3-advanced__expert input:checked ~ span::after {
  left: 34px;
  background-color: var(--md-sys-color-on-primary, #ffffff);
}

.md3-advanced__expert span {
  font: var(--md-sys-typescale-body-medium, 0.95rem) system-ui;
  color: var(--md-sys-color-on-surface, #1c1b1f);
}

/* ========================================
   SUMMARY BOX
   ======================================== */

.md3-advanced__summary {
  margin-block: var(--space-4, 1rem);
  padding: var(--space-3, 0.75rem) var(--space-4, 1rem);
  background-color: var(--md-sys-color-surface-container-low, #f9f9fb);
  border-left: 4px solid var(--md-sys-color-primary, #0a5981);
  border-radius: var(--radius-sm, 8px);
  color: var(--md-sys-color-on-surface-variant, #4A4F55);
  font: var(--md-sys-typescale-body-large, 1rem) system-ui;
}

.md3-advanced__summary[hidden] {
  display: none;
}

.md3-advanced__summary:focus {
  outline: 2px solid var(--md-sys-color-primary, #0a5981);
  outline-offset: 2px;
}

.md3-advanced__summary-query {
  font-weight: 600;
  color: var(--md-sys-color-on-surface, #1c1b1f);
}

.md3-advanced__summary-count {
  font-weight: 700;
  color: var(--md-sys-color-primary, #0a5981);
  font-size: 1.125rem;
}

.md3-advanced__summary-total {
  color: var(--md-sys-color-on-surface-variant, #4A4F55);
}

/* ========================================
   BADGE: Server-Filter aktiv
   ======================================== */

.md3-badge--serverfilter {
  display: inline-flex;
  align-items: center;
  gap: var(--space-1, 0.25rem);
  padding: var(--space-1, 0.25rem) var(--space-2, 0.5rem);
  margin-inline-start: var(--space-2, 0.5rem);
  border-radius: 999px;
  background-color: var(--md-sys-color-secondary-container, #8c9aa9);
  color: var(--md-sys-color-on-secondary-container, #000000);
  font: var(--md-sys-typescale-label-small, 0.75rem) system-ui;
  font-weight: 500;
  white-space: nowrap;
}

.md3-badge--serverfilter[hidden] {
  display: none;
}

.md3-badge--serverfilter .material-symbols-rounded {
  font-size: 1rem;
}

/* ========================================
   TOOLBAR (Export Buttons)
   ======================================== */

.md3-advanced__toolbar {
  display: flex;
  align-items: center;
  gap: var(--space-2, 0.5rem);
  margin-block-end: var(--space-3, 0.75rem);
  padding-block: var(--space-2, 0.5rem);
}

.md3-advanced__toolbar-spacer {
  flex: 1;
}

.md3-advanced__exports {
  display: flex;
  gap: var(--space-2, 0.5rem);
}

/* Export buttons inherit from global .md3-button-tonal/.md3-button-outlined */

/* ========================================
   TABLE WRAPPER
   ======================================== */

.md3-advanced__tablewrap {
  overflow-x: auto;
  overflow-y: visible;
  border-radius: var(--radius-md, 12px);
  border: 1px solid var(--md-sys-color-outline-variant, #cac4d0);
  background-color: var(--md-sys-color-surface, #ffffff);
}

/* Table: Use existing .md3-corpus-table or .md3-datatable */
.md3-advanced__tablewrap .md3-corpus-table,
.md3-advanced__tablewrap .md3-datatable {
  width: 100%;
  border-collapse: collapse;
}

/* ========================================
   RESPONSIVE: Mobile optimizations
   ======================================== */

@media (max-width: 600px) {
  .md3-advanced {
    padding-inline: var(--space-2, 0.5rem);
  }
  
  .md3-advanced__toolbar {
    flex-direction: column;
    align-items: stretch;
  }
  
  .md3-advanced__exports {
    flex-direction: column;
  }
  
  .md3-advanced__exports .md3-button-tonal,
  .md3-advanced__exports .md3-button-outlined {
    width: 100%;
  }
}

/* ========================================
   ACCESSIBILITY
   ======================================== */

/* Screen-reader only class */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* Focus visible improvements */
.md3-advanced__form input:focus-visible,
.md3-advanced__form select:focus-visible {
  outline: 2px solid var(--md-sys-color-primary, #0a5981);
  outline-offset: 2px;
}

/* ========================================
   FILTER CHECKBOXES (include_regional, sensitive)
   ======================================== */

.md3-advanced__checkboxes {
  display: flex;
  flex-direction: column;
  gap: var(--space-2, 0.5rem);
  padding-block: var(--space-2, 0.5rem);
}

.md3-advanced__checkbox-label {
  display: flex;
  align-items: center;
  gap: var(--space-2, 0.5rem);
  cursor: pointer;
  font: var(--md-sys-typescale-body-medium, 0.95rem) system-ui;
  color: var(--md-sys-color-on-surface, #1c1b1f);
}

.md3-advanced__checkbox-label input[type="checkbox"] {
  width: 20px;
  height: 20px;
  accent-color: var(--md-sys-color-primary, #0a5981);
  cursor: pointer;
}

/* ========================================
   FORM ACTIONS (Submit + Reset Buttons)
   ======================================== */

.md3-form-actions {
  display: flex !important;
  gap: var(--space-3, 0.75rem);
  margin-block-start: var(--space-4, 1rem);
  flex-wrap: wrap;
}
